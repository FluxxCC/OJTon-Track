<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OJTonTrack – Coordinator Supervisors</title>
    <link rel="stylesheet" href="/styles.css" />
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  </head>
  <body>
    <main id="root"><div class="container" style="width:min(92vw,560px);margin:2rem auto;padding:1rem;border:2px solid #d1d5db;border-radius:10px;background:#fff;text-align:center;font-weight:700;">Loading Supervisors…</div></main>
    <script>
      function authHeaders(json=false){ const t = localStorage.getItem('userToken') || sessionStorage.getItem('userToken'); const h = t ? { Authorization: 'Bearer ' + t } : {}; return json ? { 'Content-Type': 'application/json', ...h } : h; }
      async function getMe() { const r = await fetch('/api/me', { headers: authHeaders() }); const j = await r.json().catch(() => ({})); if (!r.ok) { window.location.replace('/index.html'); throw new Error('auth'); } return j; }
      function Page() {
        const [course, setCourse] = React.useState('');
        const endpoint = '/api/supervisors';
        const [items, setItems] = React.useState([]);
        const [loading, setLoading] = React.useState(true);
        const [error, setError] = React.useState('');
        const [search, setSearch] = React.useState('');
        const [filterCompany, setFilterCompany] = React.useState('');
        const [filterSection, setFilterSection] = React.useState('');
        const [sortBy, setSortBy] = React.useState('name');
        const [filtersOpen, setFiltersOpen] = React.useState(false);
        const [showAdd, setShowAdd] = React.useState(false);
        const [editing, setEditing] = React.useState(null);
        const [filterCourse, setFilterCourse] = React.useState('');
        const [hasCourseParam, setHasCourseParam] = React.useState(false);
        const [filterOpenCS, setFilterOpenCS] = React.useState(false);
        const [pickCourse, setPickCourse] = React.useState('');
        const [pickSection, setPickSection] = React.useState('');

        React.useEffect(() => { (async()=>{ try { const j = await getMe(); setCourse(String(j.data?.course || '')); } catch {} })(); const params = new URLSearchParams(window.location.search); const c = String(params.get('course')||'').trim(); if (c) { setFilterCourse(c); setFilterSection(''); setHasCourseParam(true); } }, []);

        function reload() {
          setLoading(true);
          fetch(endpoint, { headers: authHeaders() })
            .then(async (r) => {
              const data = await r.json().catch(() => ({ ok: false, error: 'Invalid JSON' }));
              if (r.ok && data && data.ok) { setItems(Array.isArray(data.data) ? data.data : []); setError(''); }
              else { setError((data && data.error) || 'Failed to load supervisors'); }
            })
            .catch(() => setError('Failed to load supervisors'))
            .finally(() => setLoading(false));
        }
        React.useEffect(() => { reload(); }, []);


        async function addSupervisor(e) {
          e.preventDefault();
          const f = e.currentTarget;
          const payload = {
            idNumber: f.idNumber.value.trim(),
            password: f.password.value.trim(),
            firstName: (f.firstName?.value || '').trim(),
            middleName: (f.middleName?.value || '').trim(),
            lastName: (f.lastName?.value || '').trim(),
            company: (f.company?.value || '').trim() || null,
            location: (f.location?.value || '').trim() || null,
            section: (f.section?.value || '').trim() || null,
            course: (f.course?.value || '').trim() || null
          };
          const resp = await fetch('/api/supervisors', { method: 'POST', headers: authHeaders(true), body: JSON.stringify(payload) });
          const json = await resp.json();
          if (resp.ok && json.ok) { f.reset(); setShowAdd(false); reload(); }
          else if ((json && json.error) === 'Forbidden') { alert('Forbidden: coordinator auth required'); } else alert(json.error || 'Failed');
        }

        async function deleteSupervisor(id) {
          const resp = await fetch('/api/supervisors/' + id, { method: 'DELETE', headers: authHeaders() });
          const json = await resp.json();
          if (resp.ok && json.ok) reload(); else if ((json && json.error) === 'Forbidden') { alert('Forbidden: coordinator auth required'); } else alert(json.error || 'Failed');
        }

        async function updateSupervisor(id, payload) {
          const resp = await fetch('/api/supervisors/' + id, { method: 'PUT', headers: authHeaders(true), body: JSON.stringify(payload) });
          const json = await resp.json();
          if (resp.ok && json.ok) reload(); else if ((json && json.error) === 'Forbidden') { alert('Forbidden: coordinator auth required'); } else alert(json.error || 'Failed');
        }

        const companies = Array.from(new Set(items.map(u => String(u.company||'').trim()).filter(Boolean))).sort();
        const sections = Array.from(new Set(items.map(u => String(u.section||'').trim()).filter(Boolean))).sort();
        const visible = items
          .filter(u => {
            const q = search.trim().toLowerCase();
            if (q && !(((u.name || '').toLowerCase().includes(q)) || ((u.idNumber || '').toLowerCase().includes(q)) || ((u.company || '').toLowerCase().includes(q)))) return false;
            if (filterCompany && String(u.company||'') !== filterCompany) return false;
            if (filterSection) {
              const raw = String(u.section||'').trim();
              const secCode = raw.includes(' ') ? raw.split(/\s+/).pop() : raw;
              if (secCode !== filterSection) return false;
            }
            if (filterCourse) {
              const c0 = String(u.course||'').trim();
              const s0 = String(u.section||'').trim();
              const inferred = (!c0 && s0) ? String(s0).split(' ')[0] : '';
              const cc = c0 || inferred || '';
              if (cc !== filterCourse) return false;
            }
            return true;
          })
          .sort((a,b)=>{
            if (sortBy==='name') return String(a.name||'').localeCompare(String(b.name||''));
            if (sortBy==='id') return String(a.idNumber||'').localeCompare(String(b.idNumber||''));
            return 0;
          });

        const [toDelete, setToDelete] = React.useState(null);
        function List() {
          if (loading) return React.createElement('div', { className: 'buttons', style: { width: '100%', margin: 0 } }, [
            React.createElement('div', { key: 'sk1', className: 'skeleton-card' }, [ React.createElement('div', { className: 'skeleton-line', style: { width:'60%' } }), React.createElement('div', { className: 'skeleton-line', style: { width:'40%', marginTop:8 } }) ]),
            React.createElement('div', { key: 'sk2', className: 'skeleton-card', style: { marginTop:8 } }, [ React.createElement('div', { className: 'skeleton-line', style: { width:'70%' } }), React.createElement('div', { className: 'skeleton-line', style: { width:'50%', marginTop:8 } }) ])
          ]);
          if (!visible.length) return React.createElement('div', { className: 'empty' }, 'No supervisors yet. Add one to get started.');
          return React.createElement('div', { className: 'buttons', style: { width: '100%', margin: 0 } }, visible.map(u => {
            const params = new URLSearchParams(window.location.search);
            const c = String(params.get('course')||'').trim();
            const href = '/coordinator/supervisor-details.html?id=' + encodeURIComponent(u.idNumber) + (c ? ('&course=' + encodeURIComponent(c)) : '');
            return React.createElement('a', { key: u.idNumber, href: href, className: 'list-card', style: { display: 'block', textDecoration: 'none', color: 'inherit', scrollSnapAlign: 'start' } }, [
              React.createElement('div', { key: 'title', className: 'title' }, `${u.name || '(No name)'} (${u.idNumber})`),
              React.createElement('div', { key: 'sub', className: 'sub' }, `Supervisor — ${u.company || 'No company'}`),
              React.createElement('div', { key: 'meta', className: 'meta' }, (() => {
                const c0 = String(u.course||'').trim();
                if (c0) return `${c0} • Section ${u.section || '—'}`;
                const s = String(u.section||'').trim();
                const inferred = s ? String(s).split(' ')[0] : '';
                return `${inferred || 'Unknown'} • Section ${u.section || '—'}`;
              })())
            ]);
          }));
        }

        function Toolbar() {
          return React.createElement('div', { key: 'toolbar', style: { width: 'min(92vw, 560px)', display: 'grid', gridTemplateColumns: '1fr', alignItems: 'center', gap: '0.75rem', margin: '0.5rem auto 1rem', background: 'var(--surface-alpha)', border: '1px solid var(--border-alpha)', borderRadius: 12, padding: '0.5rem' } }, [
            React.createElement('div', { key: 'searchWrap', className: 'search-wrap', style: { width: '100%', margin: '0 auto' } }, [
              React.createElement('input', { className: 'input', value: search, onChange: (e) => setSearch(e.target.value), placeholder: 'Search by name, ID, or company', autoComplete: 'off', autoFocus: true, spellCheck: false, type: 'search', name: 'search', inputMode: 'search', onKeyDown: (e) => { if (e.key === 'Enter') e.preventDefault(); }, style: { width: '100%' } })
            ]),
            hasCourseParam ? React.createElement('div', { key: 'secBtns', className: 'buttons', style: { display: 'grid', gridTemplateColumns: 'repeat(4,1fr)', gap: '0.5rem', width: '100%', margin: 0 } }, [
              React.createElement('button', { key: '4A', type: 'button', className: 'role-button', onClick: ()=>setFilterSection('4A') }, (filterSection==='4A'?'✓ ':'')+'4A'),
              React.createElement('button', { key: '4B', type: 'button', className: 'role-button', onClick: ()=>setFilterSection('4B') }, (filterSection==='4B'?'✓ ':'')+'4B'),
              React.createElement('button', { key: '4C', type: 'button', className: 'role-button', onClick: ()=>setFilterSection('4C') }, (filterSection==='4C'?'✓ ':'')+'4C'),
              React.createElement('button', { key: '4D', type: 'button', className: 'role-button', onClick: ()=>setFilterSection('4D') }, (filterSection==='4D'?'✓ ':'')+'4D')
            ]) : null,
            hasCourseParam ? null : React.createElement('div', { key: 'openCSWrap', style: { display: 'grid', gridTemplateColumns: '1fr', width: '100%' } }, [
              React.createElement('button', { key: 'openCS', type: 'button', className: 'role-button', onClick: ()=>{ setPickCourse(filterCourse||''); setPickSection(filterSection||''); setFilterOpenCS(true); } }, (filterCourse && filterSection ? `Course & Section: ${filterCourse} / ${filterSection}` : 'Course & Section'))
            ]),
            hasCourseParam ? null : React.createElement('div', { key: 'filtersToggle', style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' } }, [
              React.createElement('button', { key: 'toggleFilters', type: 'button', className: 'role-button', onClick: ()=>setFiltersOpen(!filtersOpen) }, filtersOpen ? 'Hide Filters' : 'Show Filters'),
              React.createElement('select', { key: 'sortSelect', className: 'input', value: sortBy, onChange: e=>setSortBy(e.target.value) }, [
                React.createElement('option', { key: 'name', value: 'name' }, 'Sort: A–Z'),
                React.createElement('option', { key: 'id', value: 'id' }, 'Sort: by ID')
              ])
            ]),
            hasCourseParam || !filtersOpen ? null : React.createElement('div', { key: 'filters', style: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '0.5rem' } }, [
              React.createElement('select', { key: 'company', className: 'input', value: filterCompany, onChange: e=>setFilterCompany(e.target.value) }, [ React.createElement('option', { key: 'any', value: '' }, 'Company: Any'), ...companies.map(c=>React.createElement('option', { key: c, value: c }, c)) ]),
              React.createElement('select', { key: 'section', className: 'input', value: filterSection, onChange: e=>setFilterSection(e.target.value) }, [ React.createElement('option', { key: 'any', value: '' }, 'Section: Any'), ...sections.map(s=>React.createElement('option', { key: s, value: s }, s)) ])
            ])
          ]);
        }

        function CustomSelect(props) {
          const { name, placeholder, options = [], required, defaultValue } = props || {};
          const [open, setOpen] = React.useState(false);
          const [value, setValue] = React.useState(defaultValue || '');
          function choose(v) { setValue(v); setOpen(false); }
          return React.createElement('div', { style: { width: '94%', margin: '0 auto' } }, [
            React.createElement('input', { key: 'hidden', type: 'text', name, value, required, style: { display: 'none' } }),
            React.createElement('button', { key: 'btn', type: 'button', className: 'input', onClick: () => setOpen(true), style: { width: '100%', textAlign: 'center' } }, value || placeholder || ''),
            open ? React.createElement('div', { key: 'overlay', style: { position: 'fixed', inset: 0, background: 'rgba(2,6,23,0.55)', backdropFilter: 'blur(4px)', display: 'grid', placeItems: 'center', zIndex: 100, padding: '1rem' }, onClick: () => setOpen(false) }, [
              React.createElement('div', { key: 'box', style: { position: 'relative', width: 'min(80vw, 360px)', maxHeight: '70vh', overflowY: 'auto', background: '#ffffff', borderRadius: 12, boxShadow: '0 20px 40px rgba(0,0,0,0.25)', padding: '0.75rem', paddingTop: '2rem' }, onClick: e => e.stopPropagation() }, [
                React.createElement('span', { key: 'x', onClick: () => setOpen(false), style: { position: 'absolute', top: 8, right: 8, cursor: 'pointer', fontSize: 18, lineHeight: 1 } }, '×'),
                React.createElement('div', { key: 'ph', style: { fontWeight: 700, textAlign: 'center', marginBottom: '0.5rem' } }, placeholder || ''),
                React.createElement('div', { key: 'list', style: { display: 'grid', gap: '0.5rem' } }, options.map(opt => React.createElement('button', { key: opt, type: 'button', className: 'role-button', onClick: () => choose(opt), style: { width: '100%', textAlign: 'center' } }, opt)))
              ])
            ]) : null
          ]);
        }

        function ModalEdit() {
          if (!editing) return null;
          React.useEffect(() => { function onKey(e) { if (e.key === 'Escape') setEditing(null); } window.addEventListener('keydown', onKey); return () => window.removeEventListener('keydown', onKey); }, [editing]);
          function submit(e) { e.preventDefault(); const f = e.currentTarget; const payload = { name: (f.name?.value || '').trim(), company: (f.company?.value || '').trim() || null, location: (f.location?.value || '').trim() || null, section: (f.section?.value || '').trim() || null }; if (!payload.name) { alert('Name is required'); return; } updateSupervisor(editing.idNumber, payload).then(() => setEditing(null)); }
          const overlayStyle = { position: 'fixed', inset: 0, background: 'rgba(2,6,23,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 50, padding: 0 };
          const modalStyle = { width: 'min(92vw, 560px)', background: '#ffffff', borderRadius: 12, boxShadow: '0 10px 30px rgba(0,0,0,0.25)', padding: '1rem', boxSizing: 'border-box', margin: 0 };
          return React.createElement('div', { key: 'overlay', style: overlayStyle, onClick: () => setEditing(null) }, [
            React.createElement('div', { key: 'modal', style: { ...modalStyle, textAlign: 'center', position: 'relative', overflow: 'hidden' }, onClick: e => e.stopPropagation() }, [
              React.createElement('div', { key: 'head', style: { display: 'flex', alignItems: 'center', justifyContent: 'center', marginBottom: '0.5rem' } }, [ React.createElement('div', { key: 'title', style: { fontWeight: 700 } }, `Edit Supervisor (${editing.idNumber})`) ]),
              React.createElement('div', { key: 'content', style: { width: '100%', margin: '0 auto' } }, [
                React.createElement('form', { key: 'form', className: 'form', onSubmit: submit, style: { display: 'grid', gap: '0.75rem', justifyItems: 'center', textAlign: 'center', marginTop: 0, width: '100%' } }, [
                  React.createElement('input', { key: 'name', className: 'input', name: 'name', defaultValue: editing.name, placeholder: 'Name', required: true, style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'company', className: 'input', name: 'company', defaultValue: editing.company, placeholder: 'Company', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'location', className: 'input', name: 'location', defaultValue: editing.location, placeholder: 'Location', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'section', className: 'input', name: 'section', defaultValue: editing.section, placeholder: 'Section (optional)', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  
                  React.createElement('div', { key: 'actions', className: 'buttons', style: { display: 'grid', gridTemplateColumns: '1fr', gap: '0.5rem', justifyItems: 'center', width: '100%', margin: 0 } }, [
                    React.createElement('button', { key: 'save', className: 'role-button', type: 'submit', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }, 'Save Changes'),
                    React.createElement('button', { key: 'cancel', className: 'role-button', type: 'button', onClick: () => setEditing(null), style: { width: '94%', margin: '0 auto', textAlign: 'center' } }, 'Cancel')
                  ])
                ])
              ])
            ])
          ]);
        }

        function DeleteConfirm(){
          if(!toDelete) return null;
          React.useEffect(()=>{ function onKey(e){ if(e.key==='Escape') setToDelete(null); } window.addEventListener('keydown', onKey); return ()=>window.removeEventListener('keydown', onKey); },[toDelete]);
          const overlayStyle = { position: 'fixed', inset: 0, background: 'rgba(2,6,23,0.5)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 50, padding: 0 };
          const modalStyle = { width: 'min(92vw, 560px)', background: 'var(--surface-alpha)', borderRadius: 12, boxShadow: '0 10px 30px rgba(0,0,0,0.25)', padding: '1rem', boxSizing: 'border-box', margin: 0 };
          function confirmDelete(){ deleteSupervisor(toDelete).then(()=>setToDelete(null)); }
          function close(){ setToDelete(null); }
          return React.createElement('div',{ key:'overlay', style: overlayStyle, onClick: close },[
            React.createElement('div',{ key:'modal', style:{ ...modalStyle, textAlign:'center', position:'relative' }, onClick:e=>e.stopPropagation() },[
              React.createElement('div',{ key:'title', style:{ fontWeight:700, marginBottom:'0.5rem' } },'Are you sure you want to delete this user?'),
              React.createElement('div',{ key:'actions', className:'buttons', style:{ display:'grid', gridTemplateColumns:'1fr', gap:'0.5rem', justifyItems:'center', width:'100%' } },[
                React.createElement('button',{ key:'yes', className:'role-button danger', type:'button', onClick: confirmDelete, style:{ width:'94%', margin:'0 auto', textAlign:'center' } },'Delete'),
                React.createElement('button',{ key:'no', className:'role-button', type:'button', onClick: close, style:{ width:'94%', margin:'0 auto', textAlign:'center' } },'Cancel')
              ])
            ])
          ]);
        }

          function AddModal() {
            if (!showAdd) return null;
          const overlayStyle = { position: 'fixed', inset: 0, background: 'rgba(2,6,23,0.5)', backdropFilter: 'blur(4px)', display: 'grid', placeItems: 'center', zIndex: 50, padding: '1rem', minHeight: '100dvh', overscrollBehavior: 'contain' };
          const modalStyle = { width: 'min(92vw, 560px)', maxHeight: '80vh', overflowY: 'auto', background: 'var(--surface-alpha)', borderRadius: 12, boxShadow: '0 10px 30px rgba(0,0,0,0.25)', padding: '1rem', boxSizing: 'border-box', margin: 0 };
          function submit(e) { addSupervisor(e); }
          function close() { setShowAdd(false); }
          React.useEffect(() => { function onKey(e){ if(e.key==='Escape') setShowAdd(false); } window.addEventListener('keydown', onKey); return () => window.removeEventListener('keydown', onKey); }, []);
          React.useEffect(() => { const prev = document.body.style.overflow; document.body.style.overflow = 'hidden'; return () => { document.body.style.overflow = prev; }; }, []);
          return React.createElement('div', { key: 'overlay', style: overlayStyle, onClick: close }, [
            React.createElement('div', { key: 'modal', style: { ...modalStyle, textAlign: 'center', position: 'relative' }, onClick: e => e.stopPropagation(), role: 'dialog', 'aria-modal': true }, [
              React.createElement('button', { key: 'x', type: 'button', onClick: close, style: { position: 'absolute', top: 8, right: 8, padding: '2px 8px', fontSize: 18, lineHeight: 1, border: 'none', background: 'transparent', cursor: 'pointer' } }, '×'),
              React.createElement('div', { key: 'content', style: { width: '100%', margin: '0 auto' } }, [
                React.createElement('form', { key: 'form', className: 'form', onSubmit: submit, style: { width: '100%', display: 'grid', gap: '0.75rem', justifyItems: 'center', textAlign: 'center', marginTop: 0 } }, [
                  React.createElement('input', { key: 'id', className: 'input', name: 'idNumber', placeholder: 'ID Number', required: true, style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'pass', className: 'input', name: 'password', placeholder: 'Password', required: true, style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'firstName', className: 'input', name: 'firstName', placeholder: 'First Name', required: true, style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'middleName', className: 'input', name: 'middleName', placeholder: 'Middle Name', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'lastName', className: 'input', name: 'lastName', placeholder: 'Last Name', required: true, style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'company', className: 'input', name: 'company', placeholder: 'Company', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement('input', { key: 'location', className: 'input', name: 'location', placeholder: 'Location', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }),
                  React.createElement(CustomSelect, { key: 'section', name: 'section', placeholder: 'Assign Section (optional)', options: ['4A','4B','4C','4D'] }),
                  React.createElement(CustomSelect, { key: 'course', name: 'course', placeholder: 'Assign Course', options: ['BSIT','BSIS','BSCS'] }),
                React.createElement('div', { key: 'actions', className: 'buttons', style: { display: 'grid', gridTemplateColumns: '1fr', gap: '0.5rem', justifyItems: 'center', width: '100%', marginTop: '0.75rem' } }, [
                  React.createElement('button', { key: 'add', className: 'role-button neutral', type: 'submit', style: { width: '94%', margin: '0 auto', textAlign: 'center' } }, 'Add Supervisor'),
                  React.createElement('button', { key: 'cancel', className: 'role-button neutral', type: 'button', onClick: close, style: { width: '94%', margin: '0 auto', textAlign: 'center' } }, 'Cancel')
                ])
                ])
              ])
            ])
          ]);
        }

        function CourseSectionModal() {
          if (!filterOpenCS) return null;
          const overlayStyle = { position: 'fixed', inset: 0, background: 'rgba(2,6,23,0.55)', backdropFilter: 'blur(4px)', display: 'grid', placeItems: 'center', zIndex: 60, padding: '1rem' };
          const modalStyle = { width: 'min(92vw, 560px)', background: '#ffffff', borderRadius: 12, boxShadow: '0 20px 40px rgba(0,0,0,0.25)', padding: '1rem' };
          function close(){ setFilterOpenCS(false); }
          function apply(){ setFilterCourse(pickCourse||''); setFilterSection(pickSection||''); setFilterOpenCS(false); }
          function clearAll(){ setPickCourse(''); setPickSection(''); setFilterCourse(''); setFilterSection(''); setFilterOpenCS(false); }
          return React.createElement('div', { key: 'overlayCS', style: overlayStyle, onClick: close }, [
            React.createElement('div', { key: 'modalCS', style: { ...modalStyle, textAlign: 'center', position: 'relative' }, onClick: e=>e.stopPropagation() }, [
              React.createElement('button', { key: 'x', type: 'button', className: 'role-button', onClick: close, style: { position: 'absolute', top: 8, right: 8, padding: '2px 8px', fontSize: 12 } }, '×'),
              React.createElement('div', { key: 'title', style: { fontWeight: 700, marginBottom: '0.5rem' } }, 'Choose Course & Section'),
              React.createElement('div', { key: 'courses', className: 'buttons', style: { display: 'grid', gridTemplateColumns: 'repeat(3,1fr)', gap: '0.5rem', width: '100%', margin: '0.5rem auto' } }, [
                React.createElement('button', { key: 'BSIT', type: 'button', className: 'role-button', onClick: ()=>{ setPickCourse('BSIT'); setPickSection(''); } }, (pickCourse==='BSIT'?'✓ ':'')+'BSIT'),
                React.createElement('button', { key: 'BSIS', type: 'button', className: 'role-button', onClick: ()=>{ setPickCourse('BSIS'); setPickSection(''); } }, (pickCourse==='BSIS'?'✓ ':'')+'BSIS'),
                React.createElement('button', { key: 'BSCS', type: 'button', className: 'role-button', onClick: ()=>{ setPickCourse('BSCS'); setPickSection(''); } }, (pickCourse==='BSCS'?'✓ ':'')+'BSCS')
              ]),
              pickCourse ? React.createElement('div', { key: 'sections', className: 'buttons', style: { display: 'grid', gridTemplateColumns: 'repeat(4,1fr)', gap: '0.5rem', width: '100%', margin: '0.5rem auto' } }, [
                React.createElement('button', { key: '4A', type: 'button', className: 'role-button', onClick: ()=>setPickSection('4A') }, (pickSection==='4A'?'✓ ':'')+'4A'),
                React.createElement('button', { key: '4B', type: 'button', className: 'role-button', onClick: ()=>setPickSection('4B') }, (pickSection==='4B'?'✓ ':'')+'4B'),
                React.createElement('button', { key: '4C', type: 'button', className: 'role-button', onClick: ()=>setPickSection('4C') }, (pickSection==='4C'?'✓ ':'')+'4C'),
                React.createElement('button', { key: '4D', type: 'button', className: 'role-button', onClick: ()=>setPickSection('4D') }, (pickSection==='4D'?'✓ ':'')+'4D')
              ]) : null,
              React.createElement('div', { key: 'actionsCS', className: 'buttons', style: { display: 'grid', gridTemplateColumns: '1fr', gap: '0.5rem', width: '100%', marginTop: '0.75rem' } }, [
                React.createElement('button', { key: 'apply', type: 'button', className: 'role-button', onClick: apply }, 'Apply'),
                React.createElement('button', { key: 'clear', type: 'button', className: 'role-button', onClick: clearAll }, 'Clear')
              ])
            ])
          ]);
        }


        return React.createElement('main', { className: 'container' }, [
          React.createElement('h1', { key: 't', className: 'title' }, 'OJTonTrack'),
          React.createElement('p', { key: 'sub', className: 'subtitle' }, `Coordinator — ${hasCourseParam ? (filterCourse || 'UNKNOWN') : (course || 'UNKNOWN')} — Supervisors`),
          React.createElement(Toolbar, { key: 'toolbar' }),
          error ? React.createElement('p', { key: 'err', style: { color: '#b91c1c', fontWeight: 600 } }, error) : null,
          hasCourseParam ? null : React.createElement('div', { key: 'counts', className: 'recent-label', style: { width: 'min(92vw, 560px)', margin: '0.5rem auto', textAlign: 'center' } }, `Showing ${visible.length} of ${items.length} supervisors`),
          React.createElement(ModalEdit, { key: 'editModal' }),
          React.createElement(DeleteConfirm, { key: 'deleteConfirm' }),
          React.createElement(AddModal, { key: 'addModal' }),
          React.createElement(CourseSectionModal, { key: 'csModal' }),
          React.createElement('div', { key: 'scrollbox', style: { width: 'min(92vw, 560px)', height: 'min(42.1vh, 287px)', overflowY: 'auto', overflowX: 'hidden', scrollSnapType: 'y mandatory', border: '1px solid var(--border-alpha)', borderRadius: 12, background: 'var(--surface-alpha)', padding: '0.75rem', margin: '0.5rem auto' } }, [ React.createElement(List, { key: 'list' }) ]),
          React.createElement('div', { key: 'backwrap', className: 'buttons', style: { width: 'min(92vw, 560px)', margin: '1rem auto 0', display: 'grid', gridTemplateColumns: '1fr', gap: '0.5rem', justifyItems: 'stretch' } }, [
            React.createElement('button', { key: 'addBottom', className: 'role-button', type: 'button', onClick: () => setShowAdd(true), style: { width: '100%' } }, 'Add Supervisor'),
            React.createElement('a', { key: 'back', className: 'role-button', href: (hasCourseParam ? '/coordinator/supervisors-select.html' : '/coordinator/users.html'), style: { width: '100%' } }, 'Back')
          ])
        ]);
      }
      (function(){
        const el = document.getElementById('root');
        if (!window.React || !window.ReactDOM) {
          if (el) el.innerHTML = '<div style="width:min(92vw,560px);margin:2rem auto;padding:1rem;border:2px solid #d1d5db;border-radius:10px;background:#fff;text-align:center;font-weight:700;">Failed to load UI. Check internet connection for CDN scripts.</div>';
          return;
        }
        try {
          const root = ReactDOM.createRoot(el);
          root.render(React.createElement(Page));
        } catch (e) {
          if (el) el.innerHTML = '<div style="width:min(92vw,560px);margin:2rem auto;padding:1rem;border:2px solid #d1d5db;border-radius:10px;background:#fff;text-align:center;font-weight:700;">Page error: ' + String(e && e.message || 'Unknown') + '</div>';
        }
      })();
    </script>
  </body>
</html>
